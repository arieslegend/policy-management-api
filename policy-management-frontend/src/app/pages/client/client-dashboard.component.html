<div class="client-dashboard">
  <header class="dashboard-header">
    <div class="header-content">
      <div class="user-welcome">
        <h1 class="dashboard-title">Mis Pólizas</h1>
        <p class="welcome-text">Bienvenido, {{ (user$ | async)?.fullName }}</p>
      </div>
      <button class="btn btn-logout" (click)="logout()">Cerrar sesión</button>
    </div>
  </header>

  <main class="dashboard-content">
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="9" y1="9" x2="15" y2="9"></line>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ (policies$ | async)?.length || 0 }}</h3>
          <p class="stat-label">Total de Pólizas</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ (activePoliciesCount$ | async) || 0 }}</h3>
          <p class="stat-label">Pólizas Activas</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ (cancelledPoliciesCount$ | async) || 0 }}</h3>
          <p class="stat-label">Pólizas Canceladas</p>
        </div>
      </div>
    </div>

    <section class="policies-section">
      <h2 class="section-title">Mis Pólizas</h2>
      
      <div class="policies-grid">
        <div class="policy-card" *ngFor="let policy of (policies$ | async)">
          <div class="policy-header">
            <div class="policy-type">
              <h3 class="policy-title">{{ getPolicyTypeName(policy.type) }}</h3>
              <span class="policy-id">#{{ policy.id }}</span>
            </div>
            <div class="policy-status">
              <span class="status-badge" [ngClass]="getStatusClass(policy.status)">
                {{ getPolicyStatusName(policy.status) }}
              </span>
            </div>
          </div>

          <div class="policy-details">
            <div class="detail-row">
              <span class="detail-label">Monto Asegurado:</span>
              <span class="detail-value">${{ policy.insuredAmount.toLocaleString() }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Fecha de Inicio:</span>
              <span class="detail-value">{{ policy.startDate | date:'dd/MM/yyyy' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Fecha de Vencimiento:</span>
              <span class="detail-value">{{ policy.endDate | date:'dd/MM/yyyy' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Estado:</span>
              <span class="detail-value" [ngClass]="getStatusClass(policy.status)">
                {{ policy.status }}
              </span>
            </div>
          </div>

          <div class="policy-actions">
            <button class="btn btn-outline btn-small">Cancelar Poliza</button>
            <button class="btn btn-primary btn-small">Gestionar</button>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="(policies$ | async)?.length === 0 && !(isLoading$ | async)">
        <div class="empty-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="9" y1="9" x2="15" y2="9"></line>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
        </div>
        <h3 class="empty-title">No tienes pólizas activas</h3>
        <p class="empty-description">Contacta a tu asesor para contratar una nueva póliza</p>
        <button class="btn btn-primary">Contactar Asesor</button>
      </div>
    </section>

    <div class="loading-overlay" *ngIf="isLoading$ | async">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
    </div>
  </main>
</div>
