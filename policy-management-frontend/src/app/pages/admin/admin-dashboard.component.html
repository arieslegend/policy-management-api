<div class="admin-dashboard">
  <header class="dashboard-header">
    <div class="header-content">
      <h1 class="dashboard-title">Panel de Administración</h1>
      <div class="user-info">
        <span class="welcome-text">Bienvenido, {{ (user$ | async)?.fullName }}</span>
        <button class="btn btn-logout" (click)="logout()">Cerrar sesión</button>
      </div>
    </div>
  </header>

  <main class="dashboard-content">
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="9" y1="9" x2="15" y2="9"></line>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ (policies$ | async)?.length || 0 }}</h3>
          <p class="stat-label">Total de Pólizas</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ (clients$ | async)?.length || 0 }}</h3>
          <p class="stat-label">Total de Clientes</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ (activePoliciesCount$ | async) || 0 }}</h3>
          <p class="stat-label">Pólizas Activas</p>
        </div>
      </div>
    </div>

    <div class="data-grid">
      <section class="data-section">
        <h2 class="section-title">Pólizas Recientes</h2>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tipo</th>
                <th>Cliente</th>
                <th>Monto Asegurado</th>
                <th>Estado</th>
                <th>Fecha Inicio</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let policy of (policies$ | async) | slice:0:5">
                <td>{{ policy.id }}</td>
                <td>{{ getPolicyTypeName(policy.type) }}</td>
                <td>{{ policy.clientId }}</td>
                <td>${{ policy.insuredAmount.toLocaleString() }}</td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusClass(policy.status)">
                    {{ getPolicyStatusName(policy.status) }}
                  </span>
                </td>
                <td>{{ policy.startDate | date:'dd/MM/yyyy' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="data-section">
        <h2 class="section-title">Clientes Recientes</h2>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Email</th>
                <th>Teléfono</th>
                <th>Identificación</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let client of (clients$ | async) | slice:0:5">
                <td>{{ client.id }}</td>
                <td>{{ client.fullName }}</td>
                <td>{{ client.email }}</td>
                <td>{{ client.phone }}</td>
                <td>{{ client.identificationNumber }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </div>

    <div class="loading-overlay" *ngIf="isLoading$ | async">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
    </div>
  </main>
</div>
